# Pull Request: Ограничение максимального количества одинаковых блюд в корзине

## Описание

Добавлена функциональность ограничения максимального количества одинаковых блюд, которые можно добавить в корзину. По умолчанию установлен лимит 10 блюд, который можно настроить для каждого ресторана отдельно через админ панель.

## Изменения

### Backend

#### База данных
- ✅ Добавлено поле `max_cart_item_quantity INTEGER DEFAULT 10` в таблицу `restaurants`
- ✅ Добавлена автоматическая миграция для существующих таблиц

#### API
- ✅ Обновлен эндпоинт создания ресторана (`POST /cities/restaurants`) - добавлена поддержка `maxCartItemQuantity`
- ✅ Обновлен эндпоинт обновления ресторана (`PATCH /cities/restaurants/:restaurantId`) - добавлена поддержка `maxCartItemQuantity`
- ✅ Обновлены эндпоинты получения ресторанов (`GET /cities/active` и `GET /cities/all`) - возвращают `maxCartItemQuantity`

### Frontend

#### Типы и API
- ✅ Добавлено поле `maxCartItemQuantity?: number` в интерфейс `Restaurant`
- ✅ Обновлены типы API для создания и обновления ресторанов

#### Корзина
- ✅ Добавлена проверка лимита при добавлении блюд в корзину
- ✅ Добавлена проверка лимита при увеличении количества блюд
- ✅ Лимит берется из настроек выбранного ресторана (по умолчанию 10)
- ✅ Добавлено поле `maxCartItemQuantity` в контекст корзины

#### Админ панель
- ✅ Добавлено поле "Максимальное количество одинаковых блюд в корзине" в форму редактирования ресторана
- ✅ Добавлена валидация значения (должно быть числом больше 0)
- ✅ Значение сохраняется в базу данных при обновлении ресторана

#### UI компоненты
- ✅ Добавлены уведомления при достижении лимита количества блюд
- ✅ Кнопки увеличения количества блокируются при достижении лимита
- ✅ Уведомления показывают текущий лимит для ресторана
- ✅ Добавлена поддержка `maxCartItemQuantity` в `MenuItemComponent` для визуального отображения лимита
- ✅ Кнопка "+" становится неактивной (disabled) при достижении максимального количества

## Измененные файлы

### Backend:
- `backend/server/databaseInit.mjs` - схема таблицы и миграция
- `backend/server/routes/citiesRoutes.mjs` - API эндпоинты

### Frontend:
- `frontend/src/shared/data/cities.ts` - типы данных
- `frontend/src/shared/api/cities/index.ts` - API клиент
- `frontend/src/shared/api/cities/serverGateway.ts` - серверный шлюз
- `frontend/src/contexts/CartContext.tsx` - логика корзины
- `frontend/src/features/admin/cities/ui/EditRestaurantModal.tsx` - форма редактирования
- `frontend/src/features/admin/cities/CitiesManagement.tsx` - управление ресторанами
- `frontend/src/features/menu/Menu.tsx` - компонент меню
- `frontend/src/shared/ui/ui/menu-item.tsx` - компонент карточки блюда с поддержкой лимита

### Документация:
- `CHANGES_FOR_VK_APP.md` - инструкция для применения изменений в ветке vk_app
- `PR_INSTRUCTIONS.md` - инструкция по созданию PR

## Тестирование

- [x] Проверено добавление блюд в корзину
- [x] Проверено ограничение максимального количества (по умолчанию 10)
- [x] Проверена настройка лимита в админ панели
- [x] Проверены уведомления при достижении лимита
- [x] Проверена блокировка кнопок при достижении лимита
- [x] Проверена миграция БД

## Обратная совместимость

✅ Все изменения полностью обратно совместимы:
- По умолчанию используется значение 10, если настройка не задана для ресторана
- Миграция БД безопасна и не удаляет существующие данные
- Если поле уже существует в БД, миграция пропустит его создание
- Существующие рестораны автоматически получат значение по умолчанию (10)

## Скриншоты

(Добавьте скриншоты админ панели с новым полем и уведомлений о лимите, если есть)

## Связанные задачи

- Добавлена возможность настройки максимального количества одинаковых блюд в корзине
- Добавлена проверка лимита при добавлении блюд
- Добавлены уведомления при достижении лимита
