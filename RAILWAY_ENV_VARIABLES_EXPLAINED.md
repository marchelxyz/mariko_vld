# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Railway

---

## VITE_CART_API_URL, VITE_CART_RECALC_URL, VITE_CART_ORDERS_URL

### –ß—Ç–æ —ç—Ç–æ?
–≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—é—Ç URL –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å **–∫–æ—Ä–∑–∏–Ω–æ–π –∏ –∑–∞–∫–∞–∑–∞–º–∏** —á–µ—Ä–µ–∑ backend API (`cart-server.mjs`).

### –ó–∞—á–µ–º –Ω—É–∂–Ω—ã?
- **VITE_CART_API_URL** ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ (`POST /api/cart/submit`)
- **VITE_CART_RECALC_URL** ‚Äî –ø–µ—Ä–µ—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∫–æ—Ä–∑–∏–Ω—ã (`POST /api/cart/recalculate`)
- **VITE_CART_ORDERS_URL** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`GET /api/cart/orders`)

### –ù—É–∂–Ω—ã –ª–∏?
**–î–ê, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã** –¥–ª—è Railway, –ø–æ—Ç–æ–º—É —á—Ç–æ:
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ –±—ç–∫–µ–Ω–¥ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ **—Ä–∞–∑–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `frontend.up.railway.app` –∏ `backend.up.railway.app`)
- –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏ (CORS)
- –ù—É–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π URL –±—ç–∫–µ–Ω–¥–∞

**–ù–ï–¢, –Ω–µ –Ω—É–∂–Ω—ã**, –µ—Å–ª–∏:
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ –±—ç–∫–µ–Ω–¥ –Ω–∞ **–æ–¥–Ω–æ–º –¥–æ–º–µ–Ω–µ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ –∏–ª–∏ nginx)
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ `/api/cart/...`

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è?
- `frontend/src/shared/api/cart/cartApi.ts` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ –∏ –ø–µ—Ä–µ—Å—á—ë—Ç –∫–æ—Ä–∑–∏–Ω—ã
- `frontend/src/shared/api/cart/ordersApi.ts` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤

### Fallback –ª–æ–≥–∏–∫–∞
–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –∑–∞–¥–∞–Ω—ã:
```typescript
// –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏:
VITE_CART_API_URL ?? "/api/cart/submit"
VITE_CART_RECALC_URL ?? "/api/cart/recalculate"  
VITE_CART_ORDERS_URL ?? "/api/cart/orders"
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ –±—ç–∫–µ–Ω–¥ –Ω–∞ –æ–¥–Ω–æ–º –¥–æ–º–µ–Ω–µ!

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: VITE_SERVER_API_URL

–í–º–µ—Å—Ç–æ —Ç—Ä—ë—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É:

```env
VITE_SERVER_API_URL=https://backend.up.railway.app/api
```

–¢–æ–≥–¥–∞ –∫–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç –Ω—É–∂–Ω—ã–µ URL:
- `/api/cart/submit` ‚Üí `https://backend.up.railway.app/api/cart/submit`
- `/api/cart/recalculate` ‚Üí `https://backend.up.railway.app/api/cart/recalculate`
- `/api/cart/orders` ‚Üí `https://backend.up.railway.app/api/cart/orders`

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `VITE_SERVER_API_URL`** –≤–º–µ—Å—Ç–æ —Ç—Ä—ë—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ –ø—Ä–æ—â–µ –∏ —É–¥–æ–±–Ω–µ–µ!

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ú–æ–∂–Ω–æ –ª–∏ –±–µ–∑ –Ω–µ—ë? |
|------------|-------------|-------------------|
| `VITE_CART_API_URL` | üü° –°—Ä–µ–¥–Ω—è—è | –î–∞, –µ—Å–ª–∏ –µ—Å—Ç—å `VITE_SERVER_API_URL` –∏–ª–∏ –æ–¥–∏–Ω –¥–æ–º–µ–Ω |
| `VITE_CART_RECALC_URL` | üü° –°—Ä–µ–¥–Ω—è—è | –î–∞, –µ—Å–ª–∏ –µ—Å—Ç—å `VITE_SERVER_API_URL` –∏–ª–∏ –æ–¥–∏–Ω –¥–æ–º–µ–Ω |
| `VITE_CART_ORDERS_URL` | üü° –°—Ä–µ–¥–Ω—è—è | –î–∞, –µ—Å–ª–∏ –µ—Å—Ç—å `VITE_SERVER_API_URL` –∏–ª–∏ –æ–¥–∏–Ω –¥–æ–º–µ–Ω |
| `VITE_SERVER_API_URL` | üü¢ –ù–∏–∑–∫–∞—è* | –î–∞, –Ω–æ —Ç–æ–≥–¥–∞ –Ω—É–∂–Ω—ã —Ç—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—ã—à–µ |

\* `VITE_SERVER_API_URL` –∏–º–µ–µ—Ç –Ω–∏–∑–∫—É—é –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –µ—ë –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ç—Ä–µ–º—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, –Ω–æ –æ–Ω–∞ —É–¥–æ–±–Ω–µ–µ.

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Railway

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è
```env
VITE_SERVER_API_URL=https://backend.up.railway.app/api
```

### –ü–æ–ª–Ω–∞—è (–µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —è–≤–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π endpoint)
```env
VITE_CART_API_URL=https://backend.up.railway.app/api/cart/submit
VITE_CART_RECALC_URL=https://backend.up.railway.app/api/cart/recalculate
VITE_CART_ORDERS_URL=https://backend.up.railway.app/api/cart/orders
```

---

## –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –±–µ–∑ —ç—Ç–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö?

### –ë–µ–∑ VITE_CART_API_URL/VITE_CART_RECALC_URL/VITE_CART_ORDERS_URL:
- ‚ùå –ù–µ–ª—å–∑—è –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑
- ‚ùå –ù–µ–ª—å–∑—è –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ—Ä–∑–∏–Ω—ã
- ‚ùå –ù–µ–ª—å–∑—è –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –Ω–æ –∫–æ—Ä–∑–∏–Ω–∞ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

### –ë–µ–∑ VITE_SERVER_API_URL (–Ω–æ —Å —Ç—Ä–µ–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –≤—ã—à–µ):
- ‚úÖ –í—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- ‚ö†Ô∏è –ü—Ä–æ—Å—Ç–æ –±–æ–ª—å—à–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## CORS_ALLOWED_ORIGINS (Backend)

### –ß—Ç–æ —ç—Ç–æ?
–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è backend —Å–µ—Ä–≤–∏—Å–∞, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ–º–µ–Ω–æ–≤, —Å –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –∫ API (CORS policy).

### –ó–∞—á–µ–º –Ω—É–∂–Ω–∞?
**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–ê** –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ–≥–¥–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ –±—ç–∫–µ–Ω–¥ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö:
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞ Vercel: `https://mariko-vld.vercel.app`
- Backend –Ω–∞ Railway: `https://hm-projecttt-vladapp.up.railway.app`
- –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏ –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS

**–û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è VK Mini App**, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –¥–æ–º–µ–Ω–∞ Vercel, –∞ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –Ω–∞ Railway backend.

### –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å?

```env
# –û–¥–∏–Ω –¥–æ–º–µ–Ω
CORS_ALLOWED_ORIGINS=https://mariko-vld.vercel.app

# –ù–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–º–µ–Ω–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
CORS_ALLOWED_ORIGINS=https://mariko-vld.vercel.app,https://your-custom-domain.com
```

### –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –±–µ–∑ –Ω–µ—ë?

**–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∑–∞–¥–∞–Ω–∞:**
- ‚úÖ Backend —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å–æ –≤—Å–µ—Ö origins (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!)
- ‚ö†Ô∏è –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è production

**–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–¥–∞–Ω–∞, –Ω–æ –¥–æ–º–µ–Ω –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω:**
- ‚ùå –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- ‚ùå –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚ùå –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –±—É–¥—É—Ç –æ—à–∏–±–∫–∏: `Access to fetch ... has been blocked by CORS policy`

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–í—Å–µ–≥–¥–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ `CORS_ALLOWED_ORIGINS` –≤ production!**

1. –î–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω Vercel: `https://mariko-vld.vercel.app`
2. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–π –¥–æ–º–µ–Ω, –¥–æ–±–∞–≤—å—Ç–µ –∏ –µ–≥–æ
3. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ wildcard (`*`) –≤ production

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [`VK_CORS_FIX.md`](./VK_CORS_FIX.md)
