# VK Mini App ключи - настройка и использование

## ✅ Реализовано

В приложении реализована поддержка VK ключей:
- **Защищённый ключ** - для проверки подписи initData на сервере
- **Сервисный ключ** - для вызовов VK API с сервера

## Что это за ключи?

### 1. Защищённый ключ (Secret Key)
- Используется для **проверки подписи** `initData` на сервере
- Аналогичен проверке подписи Telegram WebApp
- Защищает от подделки данных пользователя

### 2. Сервисный ключ (Service Key)
- Используется для вызова **VK API с сервера**
- Нужен только если вы планируете делать серверные запросы к VK API
- Например: получение данных пользователя через API, отправка уведомлений и т.д.

## Текущая реализация

В вашем проекте:

✅ **Frontend:**
- Использует `window.vk.WebApp` для получения данных пользователя
- Данные передаются в заголовке `X-VK-Id` или `X-VK-Init-Data`
- **Не требует ключей**

✅ **Backend:**
- Принимает VK ID из заголовков
- **НЕ проверяет подпись** initData (в отличие от Telegram)
- **НЕ вызывает VK API** с сервера
- **Не требует ключей**

## Когда понадобятся ключи?

### Защищённый ключ понадобится, если:
1. Вы хотите **проверять подпись** `initData` на сервере для безопасности
2. Хотите убедиться, что данные действительно пришли от VK, а не подделаны

**Пример использования:**
```javascript
// Проверка подписи VK initData (аналогично Telegram)
function verifyVKInitData(initData, secretKey) {
  // Проверка подписи через HMAC-SHA256
  // ...
}
```

### Сервисный ключ понадобится, если:
1. Планируете вызывать VK API с сервера
2. Нужно получать данные пользователя через API (вместо initData)
3. Планируете отправку уведомлений через VK API

## Рекомендация

### Для текущей реализации:
**Ключи НЕ нужны** - приложение работает без них.

### Для повышения безопасности (опционально):
Можно добавить проверку подписи VK initData на сервере, аналогично Telegram:

1. Сохранить **Защищённый ключ** в переменных окружения backend
2. Добавить функцию проверки подписи в `backend/server/routes/cartRoutes.mjs`
3. Проверять подпись перед обработкой запросов

Но это **не обязательно** для работы приложения.

## Итог

✅ **Сейчас:** Ключи НЕ нужны, приложение работает без них  
⚠️ **В будущем:** Можно добавить проверку подписи для безопасности (опционально)  
❌ **Сервисный ключ:** Нужен только если планируете серверные вызовы VK API

## Где хранить ключи (если решите добавить проверку)

Если в будущем решите добавить проверку подписи:

**Backend (.env):**
```bash
VK_SECRET_KEY=ваш_защищённый_ключ
VK_SERVICE_KEY=ваш_сервисный_ключ  # только если нужны серверные API вызовы
```

**Railway:**
```bash
railway variables set VK_SECRET_KEY=ваш_ключ --service backend
```

Но сейчас это **не требуется** для работы приложения.
